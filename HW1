import pandas as pd
import numpy as np
from numpy import log, e

#url = "https://ceiba.ntu.edu.tw/course/179702/hw/data1.txt"
raw_data = "5.8500000e+01   5.8500000e+01   5.7000000e+01   6.4000000e+01   5.4500000e+01   5.6000000e+01   5.5000000e+01   6.6500000e+01   5.7000000e+01   6.5500000e+01   5.9500000e+01   6.9000000e+01   6.4500000e+01   6.8500000e+01   5.4500000e+01   6.4000000e+01   4.8000000e+01   5.4500000e+01   7.3500000e+01   6.4500000e+01   6.8500000e+01   6.8500000e+01   5.5000000e+01   6.6000000e+01   6.7000000e+01   5.8500000e+01   6.2500000e+01   5.6500000e+01   6.8000000e+01   5.4000000e+01   6.1500000e+01   6.1000000e+01   6.4500000e+01   7.0000000e+01   5.7000000e+01   6.8500000e+01   7.4500000e+01   4.8500000e+01   6.3500000e+01   4.8500000e+01   6.3500000e+01   6.2000000e+01   5.2500000e+01   5.6500000e+01   7.3500000e+01   5.9000000e+01   6.6500000e+01   6.7000000e+01   6.4500000e+01   6.1500000e+01   5.5500000e+01   7.0000000e+01   6.9000000e+01   6.3000000e+01   6.0500000e+01   6.7000000e+01   6.3000000e+01   6.5500000e+01   6.5000000e+01   6.5500000e+01   4.9000000e+01   5.9500000e+01   6.6500000e+01   6.3000000e+01   6.5500000e+01   6.7500000e+01   6.5500000e+01   7.2500000e+01   6.0500000e+01   6.2000000e+01   4.6000000e+01   5.4000000e+01   6.8500000e+01   6.0500000e+01   6.4500000e+01   6.3500000e+01   5.3000000e+01   6.3500000e+01   4.7500000e+01   6.9500000e+01   6.3000000e+01   6.1500000e+01   5.8000000e+01   6.0000000e+01   6.4000000e+01   6.4000000e+01   7.1500000e+01   6.6000000e+01   7.1000000e+01   6.5000000e+01   7.0000000e+01   6.6500000e+01   6.3000000e+01   7.0500000e+01   6.4000000e+01   7.1500000e+01   6.7500000e+01   5.4000000e+01   5.3000000e+01   6.6500000e+01   5.6000000e+01   5.4500000e+01   6.3500000e+01   6.1500000e+01   4.6500000e+01   6.1000000e+01   5.3000000e+01   5.7500000e+01   7.0000000e+01   5.6000000e+01   6.9000000e+01   5.7500000e+01   5.0000000e+01   7.7500000e+01   5.0000000e+01   6.0000000e+01   5.9000000e+01   6.4500000e+01   5.9500000e+01   5.1500000e+01   6.6500000e+01   7.3000000e+01   4.7000000e+01   6.0000000e+01   6.1500000e+01   6.4500000e+01   6.2000000e+01   6.2000000e+01   6.7500000e+01   6.0000000e+01   6.8000000e+01   6.1000000e+01   6.4000000e+01   5.0500000e+01   5.5500000e+01   5.9500000e+01   5.0000000e+01   6.9000000e+01   5.4000000e+01   6.2000000e+01   6.4000000e+01   6.0500000e+01   5.7500000e+01   6.0500000e+01   5.1500000e+01   5.1500000e+01   4.7500000e+01   6.5500000e+01   5.5500000e+01   6.2500000e+01   6.0000000e+01   4.4500000e+01   5.3500000e+01   6.1500000e+01   5.1000000e+01   6.7500000e+01   7.0000000e+01   6.4000000e+01   6.5500000e+01   6.3000000e+01   4.9500000e+01   6.0000000e+01   6.3000000e+01   6.4500000e+01   6.7500000e+01   4.9000000e+01   5.2000000e+01   4.3500000e+01   4.9500000e+01   6.3000000e+01   5.4500000e+01   5.5500000e+01   6.1000000e+01   6.9000000e+01   5.7000000e+01   6.9500000e+01   7.2000000e+01   6.5500000e+01   6.5500000e+01   7.0500000e+01   6.1000000e+01   5.3000000e+01   5.6000000e+01   6.2500000e+01   6.0000000e+01   4.8500000e+01   6.7500000e+01   6.6000000e+01   4.5500000e+01   6.8000000e+01   6.0000000e+01   5.2000000e+01   5.6500000e+01   6.2000000e+01   6.0000000e+01   6.1000000e+01   5.9500000e+01   6.2000000e+01   6.2500000e+01   6.3000000e+01"
raw_data = raw_data.split()
data = np.asarray([float(i) for i in raw_data])
n = len(data)
p = 1/2 #initial guess
max_iter = 10

#     hard label
def log_pdf(x, mu, var):
    return -log(var) - (x-mu)**2/(2*var)

label = np.random.binomial(1, p, n)
for i in range(max_iter):
# update mu, sigma
    data0 = data[label == 0]
    data1 = data[label == 1]
    mu0 = np.mean(data0)
    var0 = np.sum( (data0 - mu0)**2/(len(data0)-1) )
    mu1 = np.mean(data1)
    var1 = np.sum( (data1 - mu1)**2/(len(data1)-1) )
    
    # predtict label
    if i != max_iter-1:
        label = log_pdf(data, mu1,var1) > log_pdf(data, mu0,var0) 

n0 = len(data0)
n1 = len(data1)
